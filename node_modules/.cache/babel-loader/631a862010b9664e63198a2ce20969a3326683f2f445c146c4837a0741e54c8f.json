{"ast":null,"code":"var _jsxFileName = \"/home/diouck/EIP/trio-signo-front/src/Home/HandLandmarkerComponent.tsx\",\n  _s = $RefreshSig$();\nimport React, { useRef, useState, useEffect } from 'react';\nimport { HandLandmarker, FilesetResolver, RunningMode } from '@mediapipe/tasks-vision';\nimport { drawConnectors, drawLandmarks } from '@mediapipe/drawing_utils';\nimport { HAND_CONNECTIONS } from '@mediapipe/hands';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst HandLandmarkerComponent = () => {\n  _s();\n  const videoRef = useRef(null);\n  const canvasRef = useRef(null);\n  const [handLandmarker, setHandLandmarker] = useState(undefined);\n  const [webcamRunning, setWebcamRunning] = useState(false);\n  const [runningMode, setRunningMode] = useState(RunningMode.IMAGE);\n  const [lastVideoTime, setLastVideoTime] = useState(-1);\n  useEffect(() => {\n    const createHandLandmarker = async () => {\n      const vision = await FilesetResolver.forVisionTasks('https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.0/wasm');\n      const landmarker = await HandLandmarker.createFromOptions(vision, {\n        baseOptions: {\n          modelAssetPath: 'https://storage.googleapis.com/mediapipe-models/hand_landmarker/hand_landmarker/float16/1/hand_landmarker.task',\n          delegate: 'GPU'\n        },\n        runningMode: runningMode,\n        // Utilisation correcte de l'énumération\n        numHands: 2\n      });\n      setHandLandmarker(landmarker);\n    };\n    createHandLandmarker();\n  }, [runningMode]);\n  const enableCam = () => {\n    if (!handLandmarker) {\n      console.log('Wait! handLandmarker not loaded yet.');\n      return;\n    }\n    if (webcamRunning) {\n      setWebcamRunning(false);\n    } else {\n      setWebcamRunning(true);\n      const constraints = {\n        video: true\n      };\n      navigator.mediaDevices.getUserMedia(constraints).then(stream => {\n        if (videoRef.current) {\n          videoRef.current.srcObject = stream;\n          videoRef.current.addEventListener('loadeddata', predictWebcam);\n        }\n      });\n    }\n  };\n  const predictWebcam = async () => {\n    if (!videoRef.current || !canvasRef.current || !handLandmarker) return;\n    const video = videoRef.current;\n    const canvas = canvasRef.current;\n    const canvasCtx = canvas.getContext('2d');\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    if (runningMode === RunningMode.IMAGE) {\n      setRunningMode(RunningMode.VIDEO);\n      await handLandmarker.setOptions({\n        runningMode: RunningMode.VIDEO\n      });\n    }\n    if (lastVideoTime !== video.currentTime) {\n      setLastVideoTime(video.currentTime);\n      const startTimeMs = performance.now();\n      const results = handLandmarker.detectForVideo(video, startTimeMs);\n      if (canvasCtx && results.landmarks) {\n        canvasCtx.clearRect(0, 0, canvas.width, canvas.height);\n        for (const landmarks of results.landmarks) {\n          drawConnectors(canvasCtx, landmarks, HAND_CONNECTIONS, {\n            color: '#00FF00',\n            lineWidth: 5\n          });\n          drawLandmarks(canvasCtx, landmarks, {\n            color: '#FF0000',\n            lineWidth: 2\n          });\n        }\n      }\n    }\n    if (webcamRunning) {\n      requestAnimationFrame(predictWebcam);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Demo: Webcam continuous hands landmarks detection\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"Hold your hand in front of your webcam to get real-time hand landmark detection.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }, this), \"Click \", /*#__PURE__*/_jsxDEV(\"b\", {\n        children: \"enable webcam\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 15\n      }, this), \" below and grant access to the webcam if prompted.\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"liveView\",\n      className: \"videoView\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: enableCam,\n        className: \"mdc-button mdc-button--raised\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"mdc-button__ripple\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"mdc-button__label\",\n          children: webcamRunning ? 'DISABLE PREDICTIONS' : 'ENABLE WEBCAM'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: 'relative'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"video\", {\n          ref: videoRef,\n          style: {\n            position: 'absolute'\n          },\n          autoPlay: true,\n          playsInline: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n          ref: canvasRef,\n          style: {\n            position: 'absolute',\n            left: 0,\n            top: 0\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 93,\n    columnNumber: 5\n  }, this);\n};\n_s(HandLandmarkerComponent, \"gHDP3rE+WmGg+XBKTwZSoHf+Vuc=\");\n_c = HandLandmarkerComponent;\nexport default HandLandmarkerComponent;\nvar _c;\n$RefreshReg$(_c, \"HandLandmarkerComponent\");","map":{"version":3,"names":["React","useRef","useState","useEffect","HandLandmarker","FilesetResolver","RunningMode","drawConnectors","drawLandmarks","HAND_CONNECTIONS","jsxDEV","_jsxDEV","HandLandmarkerComponent","_s","videoRef","canvasRef","handLandmarker","setHandLandmarker","undefined","webcamRunning","setWebcamRunning","runningMode","setRunningMode","IMAGE","lastVideoTime","setLastVideoTime","createHandLandmarker","vision","forVisionTasks","landmarker","createFromOptions","baseOptions","modelAssetPath","delegate","numHands","enableCam","console","log","constraints","video","navigator","mediaDevices","getUserMedia","then","stream","current","srcObject","addEventListener","predictWebcam","canvas","canvasCtx","getContext","width","videoWidth","height","videoHeight","VIDEO","setOptions","currentTime","startTimeMs","performance","now","results","detectForVideo","landmarks","clearRect","color","lineWidth","requestAnimationFrame","children","fileName","_jsxFileName","lineNumber","columnNumber","id","className","onClick","style","position","ref","autoPlay","playsInline","left","top","_c","$RefreshReg$"],"sources":["/home/diouck/EIP/trio-signo-front/src/Home/HandLandmarkerComponent.tsx"],"sourcesContent":["import React, { useRef, useState, useEffect } from 'react';\nimport {\n  HandLandmarker,\n  FilesetResolver,\n  RunningMode\n} from '@mediapipe/tasks-vision';\nimport { drawConnectors, drawLandmarks } from '@mediapipe/drawing_utils';\nimport { HAND_CONNECTIONS } from '@mediapipe/hands';\n\nconst HandLandmarkerComponent: React.FC = () => {\n  const videoRef = useRef<HTMLVideoElement | null>(null);\n  const canvasRef = useRef<HTMLCanvasElement | null>(null);\n  const [handLandmarker, setHandLandmarker] = useState<HandLandmarker | undefined>(undefined);\n  const [webcamRunning, setWebcamRunning] = useState<boolean>(false);\n  const [runningMode, setRunningMode] = useState<RunningMode>(RunningMode.IMAGE);\n  const [lastVideoTime, setLastVideoTime] = useState<number>(-1);\n  \n  useEffect(() => {\n    const createHandLandmarker = async () => {\n      const vision = await FilesetResolver.forVisionTasks(\n        'https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.0/wasm'\n      );\n      const landmarker = await HandLandmarker.createFromOptions(vision, {\n        baseOptions: {\n          modelAssetPath: 'https://storage.googleapis.com/mediapipe-models/hand_landmarker/hand_landmarker/float16/1/hand_landmarker.task',\n          delegate: 'GPU'\n        },\n        runningMode: runningMode,  // Utilisation correcte de l'énumération\n        numHands: 2\n      });\n      setHandLandmarker(landmarker);\n    };\n\n    createHandLandmarker();\n  }, [runningMode]);\n\n  const enableCam = () => {\n    if (!handLandmarker) {\n      console.log('Wait! handLandmarker not loaded yet.');\n      return;\n    }\n\n    if (webcamRunning) {\n      setWebcamRunning(false);\n    } else {\n      setWebcamRunning(true);\n      const constraints = { video: true };\n\n      navigator.mediaDevices.getUserMedia(constraints).then((stream) => {\n        if (videoRef.current) {\n          videoRef.current.srcObject = stream;\n          videoRef.current.addEventListener('loadeddata', predictWebcam);\n        }\n      });\n    }\n  };\n\n  const predictWebcam = async () => {\n    if (!videoRef.current || !canvasRef.current || !handLandmarker) return;\n\n    const video = videoRef.current;\n    const canvas = canvasRef.current;\n    const canvasCtx = canvas.getContext('2d');\n\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n\n    if (runningMode === RunningMode.IMAGE) {\n      setRunningMode(RunningMode.VIDEO);\n      await handLandmarker.setOptions({ runningMode: RunningMode.VIDEO });\n    }\n\n    if (lastVideoTime !== video.currentTime) {\n      setLastVideoTime(video.currentTime);\n      const startTimeMs = performance.now();\n      const results = handLandmarker.detectForVideo(video, startTimeMs);\n\n      if (canvasCtx && results.landmarks) {\n        canvasCtx.clearRect(0, 0, canvas.width, canvas.height);\n        for (const landmarks of results.landmarks) {\n          drawConnectors(canvasCtx, landmarks, HAND_CONNECTIONS, { color: '#00FF00', lineWidth: 5 });\n          drawLandmarks(canvasCtx, landmarks, { color: '#FF0000', lineWidth: 2 });\n        }\n      }\n    }\n\n    if (webcamRunning) {\n      requestAnimationFrame(predictWebcam);\n    }\n  };\n\n  return (\n    <div>\n      <h2>Demo: Webcam continuous hands landmarks detection</h2>\n      <p>\n        Hold your hand in front of your webcam to get real-time hand landmark detection.\n        <br />\n        Click <b>enable webcam</b> below and grant access to the webcam if prompted.\n      </p>\n\n      <div id=\"liveView\" className=\"videoView\">\n        <button onClick={enableCam} className=\"mdc-button mdc-button--raised\">\n          <span className=\"mdc-button__ripple\"></span>\n          <span className=\"mdc-button__label\">\n            {webcamRunning ? 'DISABLE PREDICTIONS' : 'ENABLE WEBCAM'}\n          </span>\n        </button>\n        <div style={{ position: 'relative' }}>\n          <video ref={videoRef} style={{ position: 'absolute' }} autoPlay playsInline></video>\n          <canvas ref={canvasRef} style={{ position: 'absolute', left: 0, top: 0 }}></canvas>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default HandLandmarkerComponent;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}